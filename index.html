<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Idle ARPG - Combat Test </title>
        <style>
            body {
                font-family: monospace;
                background: #0f0f0f;
                color: #f8f5f5;
                padding: 200px;
            }
            #combat-log {
                height: 400px;
                overflow-y: auto;
                border: 2px solid #130879;
                padding: 10px;
                margin-top: 20px;
            }
            .damage { color: #ff6b6b; }
            .heal { color: #51cf66; }
            .mana { color: #339af0; }
            .player-magic { color: #4dabf7; font-weight: bold; }
            .system { color: #868e96; }
            .melee { color: #ffa726; font-style: italic}
            
            /* Windfury-specific styling */
            .windfury {
                background: linear-gradient(90deg, transparent, rgba(81, 207, 102, 0.1), transparent);
                border-left: 2px solid #51cf66;
                padding-left: 8px;
                margin-left: -8px;
            }
            
            /* Combat Arena */
            #combat-arena {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 40px;
                background: linear-gradient(to bottom, #1a1a1a, #0f0f0f);
                border: 2px solid #333;
                margin: 20px 0;
                min-height: 200px;
                position: relative;
            }
            
            /* Character Containers */
            .character-slot {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            /* Sprite Containers - 32x32 */
            .sprite-container {
                width: 32px;
                height: 32px;
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
            }
            
            .sprite {
                font-size: 24px;
                font-weight: bold;
                font-family: 'Courier New', monospace;
                user-select: none;
                transition: transform 0.1s ease-out;
            }
            
            #player-sprite {
                color: #4a9eff;
                text-shadow: 0 0 10px #4a9eff;
            }
            
            #enemy-sprite {
                color: #ff4444;
                text-shadow: 0 0 10px #ff4444;
            }
            
            /* Remove idle floating animation 
            @keyframes idle-float {
                0%, 100% { transform: translateY(0); }
                50% { transform: translateY(-3px); }
            }
            */
            
            /* Attack animations - CRUNCHIER */
            .attacking {
                animation: attack-lunge 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
            }
            
            @keyframes attack-lunge {
                0% { transform: translateX(0) scale(1); }
                40% { transform: translateX(15px) scale(1.3); }
                100% { transform: translateX(0) scale(1); }
            }
            
            .enemy-attacking {
                animation: enemy-attack-lunge 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
            }
            
            @keyframes enemy-attack-lunge {
                0% { transform: translateX(0) scale(1); }
                40% { transform: translateX(-15px) scale(1.3); }
                100% { transform: translateX(0) scale(1); }
            }
            
            /* Damage taken animation - CRUNCHIER */
            .damaged {
                animation: damage-flash 0.15s !important;
            }
            
            @keyframes damage-flash {
                0% { transform: scale(1); filter: brightness(1); }
                50% { transform: scale(0.9); filter: brightness(2) hue-rotate(180deg); }
                100% { transform: scale(1); filter: brightness(1); }
            }
            
            /* Health and Mana Bars */
            .bar-container {
                width: 100px;
                height: 14px;
                background: #1a1a1a;
                border: 1px solid #444;
                position: relative;
            }
            
            .health-bar {
                height: 100%;
                background: linear-gradient(to right, #c62828, #ef5350);
                transition: width 0.3s ease;
                position: relative;
            }
            
            .mana-bar {
                height: 100%;
                background: linear-gradient(to right, #1565c0, #42a5f5);
                transition: width 0.3s ease;
            }
            
            .bar-text {
                position: absolute;
                width: 100%;
                text-align: center;
                font-size: 10px;
                line-height: 14px;
                color: white;
                text-shadow: 1px 1px 2px black;
                pointer-events: none;
            }
            
            /* Damage Splats - RuneScape Style */
            .damage-splat {
                position: absolute;
                width: 50px;
                height: 45px;
                pointer-events: none;
                z-index: 100;
                animation: splat-appear 0.05s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            }
            
            .splat-bg {
                position: absolute;
                width: 100%;
                height: 100%;
            }
            
            .splat-text {
                position: absolute;
                width: 100%;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 18px;
                font-weight: bold;
                color: white;
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.9), -1px -1px 2px rgba(0, 0, 0, 0.9);
                pointer-events: none;
            }
            
            @keyframes splat-appear {
                0% {
                    transform: scale(0);
                }
                100% {
                    transform: scale(1);
                }
            }
            
            /* Old damage number styles - keeping for reference */
            .damage-number {
                position: absolute;
                font-size: 20px;
                font-weight: bold;
                pointer-events: none;
                z-index: 100;
                opacity: 1;
                transition: opacity 0.2s ease-out, top 0.15s ease-out;
                text-shadow: 2px 2px 2px rgba(0, 0, 0, 0.9);
                animation: pop-in 0.05s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            }
            
            @keyframes pop-in {
                0% {
                    transform: scale(0);
                }
                100% {
                    transform: scale(1);
                }
            }
            
            .damage-holy {
                color: #64b5f6;
                text-shadow: 0 0 4px #2196f3, 2px 2px 2px rgba(0, 0, 0, 0.9);
            }
            
            .damage-physical {
                color: #ffa726;
                text-shadow: 0 0 4px #ff6600, 2px 2px 2px rgba(0, 0, 0, 0.9);
            }
            
            .damage-enemy {
                color: #ef5350;
                text-shadow: 0 0 4px #c62828, 2px 2px 2px rgba(0, 0, 0, 0.9);
            }
            
            /* Stats Display */
            #stats {
                display: flex;
                justify-content: space-between;
                gap: 20px;
                margin-bottom: 20px;
            }
            
            .stats-panel {
                background: #2a2a2a;
                border: 1px solid #444;
                padding: 10px;
                flex: 1;
            }
            
            .player-stats {
                text-align: left;
            }
            
            .enemy-stats {
                text-align: right;
            }
            
            /* Combat AI Panel */
            #combat-ai-panel {
                background: #2a2a2a;
                border: 1px solid #444;
                padding: 15px;
                margin-top: 20px;
            }
            
            #combat-ai-panel h3 {
                margin-top: 0;
                color: #4a9eff;
            }
            
            .ai-rule {
                background: #1a1a1a;
                border: 1px solid #333;
                padding: 10px;
                margin: 10px 0;
                display: flex;
                align-items: center;
                gap: 10px;
            }
            
            .rule-priority {
                color: #868e96;
                font-weight: bold;
                margin-right: 5px;
            }
            
            .rule-controls {
                display: flex;
                flex-direction: column;
                gap: 2px;
            }
            
            .rule-controls button {
                background: #333;
                border: 1px solid #555;
                color: white;
                cursor: pointer;
                padding: 2px 6px;
                font-size: 10px;
            }
            
            .rule-controls button:hover {
                background: #444;
            }
            
            .rule-content {
                flex: 1;
                display: flex;
                align-items: center;
                gap: 5px;
            }
            
            .rule-content input {
                width: 50px;
                background: #333;
                border: 1px solid #555;
                color: white;
                padding: 2px 5px;
            }
            
            .rule-content select {
                background: #333;
                border: 1px solid #555;
                color: white;
                padding: 2px 5px;
            }
            
            .rule-delete {
                background: #8b0000;
                border: 1px solid #a00;
                color: white;
                cursor: pointer;
                padding: 2px 8px;
            }
            
            .rule-delete:hover {
                background: #a00;
            }
            
            #add-rule-btn {
                background: #4a9eff;
                border: none;
                color: white;
                padding: 5px 15px;
                cursor: pointer;
                margin-top: 10px;
            }
            
            #add-rule-btn:hover {
                background: #5ab0ff;
            }
            
            /* Ability Cooldown Display */
            .ability-cooldowns {
                display: flex;
                gap: 10px;
                margin-top: 10px;
            }
            
            .ability-icon {
                width: 48px;
                height: 48px;
                position: relative;
                border: 2px solid #4a9eff;
                border-radius: 50%;
                background: #1a1a1a;
                transition: transform 0.1s, box-shadow 0.2s;
                user-select: none;
            }
            
            .ability-icon:hover {
                transform: scale(1.05);
                box-shadow: 0 0 10px rgba(74, 158, 255, 0.5);
            }
            
            .ability-icon:active {
                transform: scale(0.95);
            }
            
            .ability-icon.disabled {
                opacity: 0.5;
                cursor: not-allowed !important;
            }
            
            .ability-icon.disabled:hover {
                transform: scale(1);
                box-shadow: none;
            }
            
            .ability-icon:hover::after {
                content: attr(data-tooltip);
                position: absolute;
                bottom: 60px;
                left: 50%;
                transform: translateX(-50%);
                background: #2a2a2a;
                border: 1px solid #444;
                padding: 8px;
                border-radius: 4px;
                white-space: pre-line;
                width: 250px;
                font-size: 12px;
                z-index: 100;
                pointer-events: none;
            }
            
            .ability-icon-content {
                width: 100%;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 20px;
                font-weight: bold;
                color: #4a9eff;
                position: relative;
                z-index: 2;
            }
            
            /* Cooldown overlay - darkens the ability when on cooldown */
            .cooldown-overlay {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border-radius: 50%;
                background: rgba(0, 0, 0, 0.7);
                z-index: 3;
            }
            
            /* Cooldown sweep - the filling circle effect */
            .cooldown-sweep {
                position: absolute;
                top: -2px;
                left: -2px;
                width: 52px;
                height: 52px;
                border-radius: 50%;
                z-index: 4;
            }
            
            .cooldown-text {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                color: white;
                font-size: 14px;
                font-weight: bold;
                text-shadow: 1px 1px 2px black;
                z-index: 5;
            }
            
            .ability-ready {
                animation: pulse-ready 1s ease-in-out infinite;
            }
            
            @keyframes pulse-ready {
                0%, 100% { box-shadow: 0 0 5px #4a9eff; }
                50% { box-shadow: 0 0 15px #4a9eff, 0 0 25px #4a9eff; }
            }
            
            .aura-active {
                animation: aura-pulse 2s ease-in-out infinite;
            }
            
            @keyframes aura-pulse {
                0%, 100% { box-shadow: 0 0 10px #51cf66; }
                50% { box-shadow: 0 0 20px #51cf66, 0 0 30px #51cf66; }
            }
            
            @keyframes ability-activate {
                0% { box-shadow: 0 0 0 0 rgba(74, 158, 255, 0.7); }
                70% { box-shadow: 0 0 0 15px rgba(74, 158, 255, 0); }
                100% { box-shadow: 0 0 0 0 rgba(74, 158, 255, 0); }
            }
            
            .ability-activate {
                animation: ability-activate 0.4s;
            }
        </style>
    </head>
    <body>
        <div id="stats">
            <div class="stats-panel player-stats" id="player-stats"></div>
            <div class="stats-panel enemy-stats" id="enemy-stats"></div>
        </div>
        
        <!-- Combat Arena -->
        <div id="combat-arena">
            <!-- Player Side -->
            <div class="character-slot">
                <div class="sprite-container">
                    <div id="player-sprite" class="sprite">C</div>
                </div>
                <div class="bar-container">
                    <div id="player-health-bar" class="health-bar" style="width: 100%">
                        <div class="bar-text">100/100</div>
                    </div>
                </div>
                <div class="bar-container">
                    <div id="player-mana-bar" class="mana-bar" style="width: 100%">
                        <div class="bar-text">100/100</div>
                    </div>
                </div>
            </div>
            
            <!-- Summon Container - positioned in front of player -->
            <div id="summon-container" style="position: absolute; left: 0; bottom: 0; width: 100%; height: 100%; pointer-events: none;"></div>
            
            <!-- Enemy Side -->
            <div class="character-slot">
                <div class="sprite-container">
                    <div id="enemy-sprite" class="sprite">S</div>
                </div>
                <div class="bar-container">
                    <div id="enemy-health-bar" class="health-bar" style="width: 100%">
                        <div class="bar-text">100/100</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Combat AI Panel -->
        <div id="combat-ai-panel">
            <h3>Combat AI Rules</h3>
            <div id="rules-list"></div>
            <button id="add-rule-btn">+ Add Rule</button>
        </div>
        
        <div id="combat-log"></div>
        <script type="module" src="/src/main.ts"></script>
    </body>
</html>